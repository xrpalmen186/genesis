{% extends 'base.html' %}
{% block title %}Checkout | Tienda Apple{% endblock %}
{% block content %}
<h2>Checkout</h2>

<h5>Resumen</h5>
<ul>
  {% for product, qty, price in items %}
    <li>{{ qty }} × {{ product.name }} — {{ price }} € — Subtotal: {{ price|floatformat:2|add:"0" }} €</li>
  {% endfor %}
</ul>

<p class="fw-bold">Total a pagar: {{ total }} €</p>

{% if profile %}
  <p>Saldo disponible: {{ profile.balance }} €</p>
{% endif %}

<form method="post">
  {% csrf_token %}
  <div class="form-check mb-3">
    <input class="form-check-input" type="checkbox" value="1" id="pay_with_balance" name="pay_with_balance">
    <label class="form-check-label" for="pay_with_balance">
      Pagar con saldo disponible
    </label>
  </div>

  <button type="submit" class="btn btn-primary">Finalizar compra</button>
  <a href="{% url 'cart_detail' %}" class="btn btn-secondary">Volver al carrito</a>
</form>
{% endblock %}
